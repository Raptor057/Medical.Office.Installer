# scripts/start.sh.in
#!/bin/bash

set -e

export GHCR_USERNAME="@GHCR_USERNAME@"
export GHCR_PAT="@GHCR_PAT@"

# Detectar sistema operativo y verificar Docker
if [[ "$OSTYPE" == "darwin"* ]]; then
  bash scripts/check_docker_macos.sh
else
  bash scripts/check_docker_linux.sh
fi

# Login a GHCR
echo "$GHCR_PAT" | docker login ghcr.io -u "$GHCR_USERNAME" --password-stdin

echo "üîç Verificando actualizaciones de im√°genes..."
docker-compose pull

echo "‚è¨ Apagando contenedores anteriores (si existen)..."
docker-compose down

echo "üöÄ Iniciando contenedores..."
docker-compose up -d
